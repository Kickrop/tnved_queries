--09.2019
--‚ÒÂ„Ó
select right(period,4) as "god", sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '› '
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,2) = '57' and tnved not in ('570310', '570320'))
or (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and tnved not in ('460290'))
or (left(tnved, 5) in ('94038','95045'))
or (left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490'))
)
group by god
order by god
----
--select right(period,4) as "god", left(tnved,2) --, sum(stoim)
--from tcbt
--where (left(tnved,2)='57')
---
select god, sum(sum) from (
select right(period,4) as "god", left(tnved,2), sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '› '
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,2) = '57' and tnved not in ('570310', '570320'))
-- (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and left(tnved,6) not in ('460290'))
--left(tnved, 5) in ('94038','95045')
--or left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490')
)
group by god, left(tnved,2)
union all
select right(period,4) as "god", left(tnved,4), sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '› '
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and left(tnved,6) not in ('460290'))
)
group by god, left(tnved,4)
union all
select right(period,4) as "god", left(tnved,5), sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '› '
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
left(tnved, 5) in ('94038','95045')
)
group by god, left(tnved,5)
union all
select right(period,4) as "god", left(tnved,6), sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '› '
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490')
)
group by god, left(tnved,6)
) x
group by god
---
select tnved
from tcbt
where right(period,4) = '2016' --and length(tnved)=8


--CREATE INDEX idx_left_5 ON tcbt(left(tnved, 5));

select region from tcbt
where region like '%ÃŒ— ¬¿%'
--
--delete from tcbt
--where right(period,4) = '2016'

--ALTER TABLE tcbt
--DROP COLUMN kol;

--11.09.2019
select tnved_6
, sum(case when  god='2016' then sum end) "2016"
, sum(case when  god='2017' then sum end) "2017"
, sum(case when  god='2018' then sum end) "2018"
from (
select right(period,4) as god, (left(tnved,6)) tnved_6,sum(stoim) --round(sum(stoim)/1000000,1)
from tcbt
where napr = '»Ã'
and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(left(tnved,6) in ('490600','711810','711890','710122','710239','710391','710399','710490','710229','710510','710590','711311',	'711319',	'711320',	'711411',	'711419',	'711420',	'911310',	'911310',	'711590',	'711610',	'711620',	'711620',	'911320',	'711711',	'711719',	'711790',	'920110',	'920120',	'920190',	'920210',	'920210',	'920290',	'920290',	'920510',	'920590',	'920590',	'920590',	'920590',	'920710',	'920710',	'920710',	'920710',	'920790',	'920790',	'920600',	'920810',	'920890',	'920930',	'920999',	'920999',	'920991',	'920992',	'920994',	'370610',	'370610',	'370690',	'370690',	'370690',	'852329',	'852349',	'852349',	'852349',	'852351',	'852359',	'490400',	'852349',	'852349',	'852380',	'370400',	'370400',	'370510',	'370590',	'370590',	'970110',	'970190',	'970200',	'970300',	'970400',	'970500',	'970600',	'490300',	'490191',	'490591',	'490599',	'490110',	'490199',	'490210',	'490290',	'490900',	'491191',	'490810',	'490890',	'491000',	'490700',	'490700',	'490700',	'491110',	'491110',	'491199',	'852329',	'852349',	'852349',	'852351',	'852359',	'852380',	'852329',	'852349',	'852349',	'852351',	'852359',	'852380'))
group by god, (left(tnved,6))
) x
group by tnved_6
--09.2019




--04.12.2019
--EXPORT/IMPORT
select 
	right(period,4) as "god"
	--,
	--left(tnved,2)
	--, count(stoim)--
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '»Ã'
--and region like '%ÃŒ— ¬¿%'
and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,4) in ('3926','4015','4203','4303','4304','7019')) or
(left(tnved,2) in ('50') and left(tnved,4) not in ('5001','5002','5003')) or 
(left(tnved,2) in ('51') and left(tnved,4) not in ('5101','5102','5103','5104','5105','5113')) or
(left(tnved,2) in ('52') and left(tnved,4) not in ('5201','5202','5203')) or
(left(tnved,2) in ('53') and left(tnved,4) not in ('5301','5302','5303','5304','5305')) or
(left(tnved,2) in ('54')) or
(left(tnved,2) in ('55') and left(tnved,4) not in ('5501','5502','5503','5504','5505')) or
(left(tnved,2) in ('56')) or
(left(tnved,2) in ('57')) or
(left(tnved,2) in ('58')) or
(left(tnved,2) in ('59')) or
(left(tnved,2) in ('60')) or
(left(tnved,2) in ('61')) or
(left(tnved,2) in ('62')) or
(left(tnved,2) in ('63') and left(tnved,4) not in ('6309','6310')) or
(left(tnved,2) in ('64')) or
(left(tnved,2) in ('65'))
--left(tnved,2) in ('50','51','52','53','54','55','56','57','58','59','60','61','62','63','64','65')
--left(tnved,6) = '392620'
--(left(tnved,2) = '57' and tnved not in ('570310', '570320'))
--or (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and tnved not in ('460290'))
--or (left(tnved, 5) in ('94038','95045'))
--or (left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490'))
)
group by 
	god
	--,
	--left(tnved,2)
order by god
--CREATE INDEX idx_tcbt_tnved ON tcbt(tnved);
--CREATE INDEX idx_tcbt_region ON tcbt(region)

--
select 
	kod_tnved
	, sum(case when  god='2016' then sum end) "2016"
	, sum(case when  god='2017' then sum end) "2017"
	, sum(case when  god='2018' then sum end) "2018"
from (
(select 
	right(period,4) as "god"
	,left(tnved,4) as kod_tnved
	--, count(stoim)--
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,4) in ('3926','4015','4203','4303','4304','7019'))
)
group by 
	god
	,left(tnved,4)
order by god)
union 
(select 
	right(period,4) as "god"
	,left(tnved,2) kod_tnved
	--, count(stoim)--
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,2) in ('50') and left(tnved,4) not in ('5001','5002','5003')) or 
(left(tnved,2) in ('51') and left(tnved,4) not in ('5101','5102','5103','5104','5105','5113')) or
(left(tnved,2) in ('52') and left(tnved,4) not in ('5201','5202','5203')) or
(left(tnved,2) in ('53') and left(tnved,4) not in ('5301','5302','5303','5304','5305')) or
(left(tnved,2) in ('54')) or
(left(tnved,2) in ('55') and left(tnved,4) not in ('5501','5502','5503','5504','5505')) or
(left(tnved,2) in ('56')) or
(left(tnved,2) in ('57')) or
(left(tnved,2) in ('58')) or
(left(tnved,2) in ('59')) or
(left(tnved,2) in ('60')) or
(left(tnved,2) in ('61')) or
(left(tnved,2) in ('62')) or
(left(tnved,2) in ('63') and left(tnved,4) not in ('6309','6310')) or
(left(tnved,2) in ('64')) or
(left(tnved,2) in ('65'))
--or (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and tnved not in ('460290'))
--or (left(tnved, 5) in ('94038','95045'))
--or (left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490'))
)
group by 
	god
	,left(tnved,2)
	)
) x
group by kod_tnved
--


--by country (import)
select 
	kod_tnved
	, strana
	, sum(case when  god='2016' then sum end) "2016"
	, sum(case when  god='2017' then sum end) "2017"
	, sum(case when  god='2018' then sum end) "2018"
	, sum(sum) as total
from (
(select 
	right(period,4) as "god"
	,left(tnved,4) as kod_tnved
	--, count(stoim)--
	,strana
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,4) in ('3926','4015','4203','4303','4304','7019'))
)
group by 
	god
	,left(tnved,4)
	,strana
)
union 
(select 
	right(period,4) as "god"
	,left(tnved,2) kod_tnved
	,strana
	--, count(stoim)--
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,2) in ('50') and left(tnved,4) not in ('5001','5002','5003')) or 
(left(tnved,2) in ('51') and left(tnved,4) not in ('5101','5102','5103','5104','5105','5113')) or
(left(tnved,2) in ('52') and left(tnved,4) not in ('5201','5202','5203')) or
(left(tnved,2) in ('53') and left(tnved,4) not in ('5301','5302','5303','5304','5305')) or
(left(tnved,2) in ('54')) or
(left(tnved,2) in ('55') and left(tnved,4) not in ('5501','5502','5503','5504','5505')) or
(left(tnved,2) in ('56')) or
(left(tnved,2) in ('57')) or
(left(tnved,2) in ('58')) or
(left(tnved,2) in ('59')) or
(left(tnved,2) in ('60')) or
(left(tnved,2) in ('61')) or
(left(tnved,2) in ('62')) or
(left(tnved,2) in ('63') and left(tnved,4) not in ('6309','6310')) or
(left(tnved,2) in ('64')) or
(left(tnved,2) in ('65'))
--or (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and tnved not in ('460290'))
--or (left(tnved, 5) in ('94038','95045'))
--or (left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490'))
)
group by 
	god
	,left(tnved,2)
	,strana
--order by god,left(tnved,2),sum	desc
	)
) x
group by kod_tnved,strana
order by kod_tnved,total desc
--


--by country (export)
select 
	kod_tnved
	, strana
	, sum(case when  god='2016' then sum end) "2016"
	, sum(case when  god='2017' then sum end) "2017"
	, sum(case when  god='2018' then sum end) "2018"
	, sum(sum) as total
from (
(select 
	right(period,4) as "god"
	,left(tnved,4) as kod_tnved
	--, count(stoim)--
	,strana
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,4) in ('3926','4015','4203','4303','4304','7019'))
)
group by 
	god
	,left(tnved,4)
	,strana
)
union 
(select 
	right(period,4) as "god"
	,left(tnved,2) kod_tnved
	,strana
	--, count(stoim)--
	,sum(stoim) --round(sum(stoim)/1000000,1)
from stat_customs.tcbt
where napr = '› '
--and region like '%ÃŒ— ¬¿%'
--and region = '45000 - √Œ–Œƒ ÃŒ— ¬¿ —“ŒÀ»÷¿ –Œ——»…— Œ… ‘≈ƒ≈–¿÷»» √Œ–Œƒ ‘≈ƒ≈–¿À‹ÕŒ√Œ «Õ¿◊≈Õ»ﬂ' --right(period,4) = '2016'--and tnved <> 'SSSSSS'
and 
(
(left(tnved,2) in ('50') and left(tnved,4) not in ('5001','5002','5003')) or 
(left(tnved,2) in ('51') and left(tnved,4) not in ('5101','5102','5103','5104','5105','5113')) or
(left(tnved,2) in ('52') and left(tnved,4) not in ('5201','5202','5203')) or
(left(tnved,2) in ('53') and left(tnved,4) not in ('5301','5302','5303','5304','5305')) or
(left(tnved,2) in ('54')) or
(left(tnved,2) in ('55') and left(tnved,4) not in ('5501','5502','5503','5504','5505')) or
(left(tnved,2) in ('56')) or
(left(tnved,2) in ('57')) or
(left(tnved,2) in ('58')) or
(left(tnved,2) in ('59')) or
(left(tnved,2) in ('60')) or
(left(tnved,2) in ('61')) or
(left(tnved,2) in ('62')) or
(left(tnved,2) in ('63') and left(tnved,4) not in ('6309','6310')) or
(left(tnved,2) in ('64')) or
(left(tnved,2) in ('65'))
--or (left(tnved,4) in ('3705','3706','4601','4814','4901','4902','4905','4908','5806','5808','5810','6002','6003','6004','6117','6214','6215',	'6217',	'6913',	'7113',	'7114','7116',	'8215',	'9201',	'9202','9205','9206','9207','9208','9505','9601','9701') and left(tnved,5) not in ('82159') and tnved not in ('460290'))
--or (left(tnved, 5) in ('94038','95045'))
--or (left(tnved,6) in ('392640',	'420211',	'420212',	'420221',	'420222',	'420231',	'420292',	'420310',	'420329',	'420330',	'420340',	'430310',	'441900',	'442010',	'442090',	'480100',	'480210',	'490300',	'490400',	'490600',	'490900',	'491000',	'491100',	'491191',	'570310',	'570390',	'570410',	'570500',	'580410',	'580421',	'580429',	'580430',	'580500',	'581100',	'590500',	'630232',	'630240',	'630411',	'630491',	'630800',	'650400',	'650500',	'650699',	'670290',	'691110',	'691200',	'691410',	'701310',	'701322',	'701333',	'701341',	'701342',	'701391',	'701890',	'711711',	'711719',	'825352',	'830610',	'830621',	'830629',	'852321',	'852329',	'852340',	'852351',	'852359',	'852380',	'900410',	'940320',	'940340',	'940350',	'940360',	'940510',	'940530',	'950300',	'950420',	'950430',	'950440',	'950810',	'970200',	'970300',	'970400',	'970500',	'970600',	'950490'))
)
group by 
	god
	,left(tnved,2)
	,strana
--order by god,left(tnved,2),sum	desc
	)
) x
group by kod_tnved,strana
order by kod_tnved,total desc

